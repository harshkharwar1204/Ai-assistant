"use strict";(()=>{var e={};e.id=233,e.ids=[233],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},9801:e=>{e.exports=require("os")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},4175:e=>{e.exports=require("tty")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},1568:e=>{e.exports=require("zlib")},2485:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>m,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>d,staticGenerationAsyncStorage:()=>p});var s={};r.r(s),r.d(s,{GET:()=>u});var n=r(9303),a=r(8716),o=r(670),i=r(7070);async function u(){let e=process.env.ICLOUD_USERNAME,t=process.env.ICLOUD_APP_PASSWORD;if(!e||!t)return i.NextResponse.json({error:"iCloud credentials not configured. Set ICLOUD_USERNAME and ICLOUD_APP_PASSWORD in .env.local"},{status:500});try{let{createDAVClient:s}=await Promise.all([r.e(304),r.e(625)]).then(r.bind(r,1625)),n=await s({serverUrl:"https://caldav.icloud.com",credentials:{username:e,password:t},authMethod:"Basic",defaultAccountType:"caldav"}),a=(await n.fetchCalendars()).filter(e=>e.components?.includes("VTODO"));if(0===a.length)return i.NextResponse.json({error:"No reminder lists found. Make sure Reminders is enabled for CalDAV."},{status:404});let o=[];for(let e of a)try{for(let t of(await n.fetchCalendarObjects({calendar:e}))){let e;let r=t.data;if(!r||!r.includes("VTODO"))continue;let s=r.match(/SUMMARY:(.+)/),n=r.match(/STATUS:(.+)/),a=r.match(/DUE(?:;[^:]*)?:(\d{8}(?:T\d{6}Z?)?)/),i=s?.[1]?.trim(),u=n?.[1]?.trim();if(!i||"COMPLETED"===u)continue;let l=new Date().toISOString().split("T")[0];if(a){let t=a[1];if(t.length>=8){let r=t.substring(0,4),s=t.substring(4,6),n=t.substring(6,8);if(l=`${r}-${s}-${n}`,t.length>8){let a=t.substring(9,11),o=t.substring(11,13);e=new Date(`${r}-${s}-${n}T${a}:${o}:00Z`).toISOString()}}}o.push({id:`icloud-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,title:i,status:"pending",scheduledDate:l,dueTime:e,createdAt:new Date().toISOString()})}}catch(t){console.error(`Error fetching calendar ${e.displayName}:`,t)}return i.NextResponse.json(o)}catch(e){return console.error("iCloud sync error:",e),i.NextResponse.json({error:e.message||"Failed to connect to iCloud CalDAV"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/tasks/sync/route",pathname:"/api/tasks/sync",filename:"route",bundlePath:"app/api/tasks/sync/route"},resolvedPagePath:"C:\\Users\\kharw\\OneDrive\\Desktop\\ai-assistant\\src\\app\\api\\tasks\\sync\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:p,serverHooks:d}=l,h="/api/tasks/sync/route";function m(){return(0,o.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:p})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,972],()=>r(2485));module.exports=s})();