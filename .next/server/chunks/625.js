exports.id=625,exports.ids=[625],exports.modules={4727:function(e,t,r){var s,a,n,i,o,c,l;(e=r.nmd(e))&&e.exports,(a="object"==typeof global&&global).global===a||a.window,(n=function(e){this.message=e}).prototype=Error(),n.prototype.name="InvalidCharacterError",i=function(e){throw new n(e)},o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=/[\t\n\f\r ]/g,l={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&i("The string to be encoded contains characters outside of the Latin1 range.");for(var t,r,s,a=e.length%3,n="",c=-1,l=e.length-a;++c<l;)s=(t=e.charCodeAt(c)<<16)+(e.charCodeAt(++c)<<8)+e.charCodeAt(++c),n+=o.charAt(s>>18&63)+o.charAt(s>>12&63)+o.charAt(s>>6&63)+o.charAt(63&s);return 2==a?(s=(t=e.charCodeAt(c)<<8)+e.charCodeAt(++c),n+=o.charAt(s>>10)+o.charAt(s>>4&63)+o.charAt(s<<2&63)+"="):1==a&&(s=e.charCodeAt(c),n+=o.charAt(s>>2)+o.charAt(s<<4&63)+"=="),n},decode:function(e){var t,r,s=(e=String(e).replace(c,"")).length;s%4==0&&(s=(e=e.replace(/==?$/,"")).length),(s%4==1||/[^+a-zA-Z0-9/]/.test(e))&&i("Invalid character: the string to be decoded is not correctly encoded.");for(var a=0,n="",l=-1;++l<s;)r=o.indexOf(e.charAt(l)),t=a%4?64*t+r:r,a++%4&&(n+=String.fromCharCode(255&t>>(-2*a&6)));return n},version:"1.0.0"},void 0!==(s=(function(){return l}).call(t,r,t,e))&&(e.exports=s)},3664:(e,t,r)=>{let s=r(820),a=s.default||s,n=function(e,t){return/^\/\//.test(e)&&(e="https:"+e),a.call(this,e,t)};n.ponyfill=!0,e.exports=t=n,t.fetch=n,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,t.default=n},3050:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;t.splice(1,0,r,"color: inherit");let s=0,a=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(s++,"%c"===e&&(a=s))}),t.splice(a,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){let e;return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(783)(t);let{formatters:s}=e.exports;s.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},783:(e,t,r)=>{e.exports=function(e){function t(e){let r,a,n;let i=null;function o(...e){if(!o.enabled)return;let s=Number(new Date),a=s-(r||s);o.diff=a,o.prev=r,o.curr=s,r=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let n=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,s)=>{if("%%"===r)return"%";n++;let a=t.formatters[s];if("function"==typeof a){let t=e[n];r=a.call(o,t),e.splice(n,1),n--}return r}),t.formatArgs.call(o,e),(o.log||t.log).apply(o,e)}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=s,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==i?i:(a!==t.namespaces&&(a=t.namespaces,n=t.enabled(e)),n),set:e=>{i=e}}),"function"==typeof t.init&&t.init(o),o}function s(e,r){let s=t(this.namespace+(void 0===r?":":r)+e);return s.log=this.log,s}function a(e,t){let r=0,s=0,a=-1,n=0;for(;r<e.length;)if(s<t.length&&(t[s]===e[r]||"*"===t[s]))"*"===t[s]?(a=s,n=r):r++,s++;else{if(-1===a)return!1;s=a+1,r=++n}for(;s<t.length&&"*"===t[s];)s++;return s===t.length}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){let e=[...t.names,...t.skips.map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){for(let r of(t.save(e),t.namespaces=e,t.names=[],t.skips=[],("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean)))"-"===r[0]?t.skips.push(r.slice(1)):t.names.push(r)},t.enabled=function(e){for(let r of t.skips)if(a(e,r))return!1;for(let r of t.names)if(a(e,r))return!0;return!1},t.humanize=r(3974),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(r=>{t[r]=e[r]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},9092:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||process.__nwjs?e.exports=r(3050):e.exports=r(2226)},2226:(e,t,r)=>{let s=r(4175),a=r(1764);t.init=function(e){e.inspectOpts={};let r=Object.keys(t.inspectOpts);for(let s=0;s<r.length;s++)e.inspectOpts[r[s]]=t.inspectOpts[r[s]]},t.log=function(...e){return process.stderr.write(a.formatWithOptions(t.inspectOpts,...e)+"\n")},t.formatArgs=function(r){let{namespace:s,useColors:a}=this;if(a){let t=this.color,a="\x1b[3"+(t<8?t:"8;5;"+t),n=`  ${a};1m${s} \u001B[0m`;r[0]=n+r[0].split("\n").join("\n"+n),r.push(a+"m+"+e.exports.humanize(this.diff)+"\x1b[0m")}else r[0]=(t.inspectOpts.hideDate?"":new Date().toISOString()+" ")+s+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?!!t.inspectOpts.colors:s.isatty(process.stderr.fd)},t.destroy=a.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{let e=r(7057);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{let r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(e,t)=>t.toUpperCase()),s=process.env[t];return s=!!/^(yes|on|true|enabled)$/i.test(s)||!/^(no|off|false|disabled)$/i.test(s)&&("null"===s?null:Number(s)),e[r]=s,e},{}),e.exports=r(783)(t);let{formatters:n}=e.exports;n.o=function(e){return this.inspectOpts.colors=this.useColors,a.inspect(e,this.inspectOpts).split("\n").map(e=>e.trim()).join(" ")},n.O=function(e){return this.inspectOpts.colors=this.useColors,a.inspect(e,this.inspectOpts)}},2616:e=>{"use strict";e.exports=(e,t=process.argv)=>{let r=e.startsWith("-")?"":1===e.length?"-":"--",s=t.indexOf(r+e),a=t.indexOf("--");return -1!==s&&(-1===a||s<a)}},5074:(e,t,r)=>{!function(e){e.parser=function(e,t){return new o(e,t)},e.SAXParser=o,e.SAXStream=l,e.createStream=function(e,t){return new l(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,s,a,n,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function o(t,r){if(!(this instanceof o))return new o(t,r);(function(e){for(var t=0,r=i.length;t<r;t++)e[i[t]]=""})(this),this.q=this.c="",this.bufferCheckPosition=e.MAX_BUFFER_LENGTH,this.opt=r||{},this.opt.lowercase=this.opt.lowercase||this.opt.lowercasetags,this.looseCase=this.opt.lowercase?"toLowerCase":"toUpperCase",this.tags=[],this.closed=this.closedRoot=this.sawRoot=!1,this.tag=this.error=null,this.strict=!!t,this.noscript=!!(t||this.opt.noscript),this.state=T.BEGIN,this.strictEntities=this.opt.strictEntities,this.ENTITIES=this.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),this.attribList=[],this.opt.xmlns&&(this.ns=Object.create(h)),void 0===this.opt.unquotedAttributeValues&&(this.opt.unquotedAttributeValues=!t),this.trackPosition=!1!==this.opt.position,this.trackPosition&&(this.position=this.line=this.column=0),C(this,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}),o.prototype={end:function(){_(this)},write:function(t){if(this.error)throw this.error;if(this.closed)return N(this,"Cannot write after close. Assign an onready handler.");if(null===t)return _(this);"object"==typeof t&&(t=t.toString());for(var r=0,s="";s=V(t,r++),this.c=s,s;)switch(this.trackPosition&&(this.position++,"\n"===s?(this.line++,this.column=0):this.column++),this.state){case T.BEGIN:if(this.state=T.BEGIN_WHITESPACE,"\uFEFF"===s)continue;S(this,s);continue;case T.BEGIN_WHITESPACE:S(this,s);continue;case T.TEXT:if(this.sawRoot&&!this.closedRoot){for(var a=r-1;s&&"<"!==s&&"&"!==s;)(s=V(t,r++))&&this.trackPosition&&(this.position++,"\n"===s?(this.line++,this.column=0):this.column++);this.textNode+=t.substring(a,r-1)}"<"!==s||this.sawRoot&&this.closedRoot&&!this.strict?(g(s)||this.sawRoot&&!this.closedRoot||x(this,"Text data outside of root node."),"&"===s?this.state=T.TEXT_ENTITY:this.textNode+=s):(this.state=T.OPEN_WAKA,this.startTagPosition=this.position);continue;case T.SCRIPT:"<"===s?this.state=T.SCRIPT_ENDING:this.script+=s;continue;case T.SCRIPT_ENDING:"/"===s?this.state=T.CLOSE_TAG:(this.script+="<"+s,this.state=T.SCRIPT);continue;case T.OPEN_WAKA:"!"===s?(this.state=T.SGML_DECL,this.sgmlDecl=""):g(s)||(A(p,s)?(this.state=T.OPEN_TAG,this.tagName=s):"/"===s?(this.state=T.CLOSE_TAG,this.tagName=""):"?"===s?(this.state=T.PROC_INST,this.procInstName=this.procInstBody=""):(x(this,"Unencoded <"),this.startTagPosition+1<this.position&&(s=Array(this.position-this.startTagPosition).join(" ")+s),this.textNode+="<"+s,this.state=T.TEXT));continue;case T.SGML_DECL:if(this.sgmlDecl+s==="--"){this.state=T.COMMENT,this.comment="",this.sgmlDecl="";continue}this.doctype&&!0!==this.doctype&&this.sgmlDecl?(this.state=T.DOCTYPE_DTD,this.doctype+="<!"+this.sgmlDecl+s,this.sgmlDecl=""):"[CDATA["===(this.sgmlDecl+s).toUpperCase()?(b(this,"onopencdata"),this.state=T.CDATA,this.sgmlDecl="",this.cdata=""):"DOCTYPE"===(this.sgmlDecl+s).toUpperCase()?(this.state=T.DOCTYPE,(this.doctype||this.sawRoot)&&x(this,"Inappropriately located doctype declaration"),this.doctype="",this.sgmlDecl=""):">"===s?(b(this,"onsgmldeclaration",this.sgmlDecl),this.sgmlDecl="",this.state=T.TEXT):(E(s)&&(this.state=T.SGML_DECL_QUOTED),this.sgmlDecl+=s);continue;case T.SGML_DECL_QUOTED:s===this.q&&(this.state=T.SGML_DECL,this.q=""),this.sgmlDecl+=s;continue;case T.DOCTYPE:">"===s?(this.state=T.TEXT,b(this,"ondoctype",this.doctype),this.doctype=!0):(this.doctype+=s,"["===s?this.state=T.DOCTYPE_DTD:E(s)&&(this.state=T.DOCTYPE_QUOTED,this.q=s));continue;case T.DOCTYPE_QUOTED:this.doctype+=s,s===this.q&&(this.q="",this.state=T.DOCTYPE);continue;case T.DOCTYPE_DTD:"]"===s?(this.doctype+=s,this.state=T.DOCTYPE):"<"===s?(this.state=T.OPEN_WAKA,this.startTagPosition=this.position):E(s)?(this.doctype+=s,this.state=T.DOCTYPE_DTD_QUOTED,this.q=s):this.doctype+=s;continue;case T.DOCTYPE_DTD_QUOTED:this.doctype+=s,s===this.q&&(this.state=T.DOCTYPE_DTD,this.q="");continue;case T.COMMENT:"-"===s?this.state=T.COMMENT_ENDING:this.comment+=s;continue;case T.COMMENT_ENDING:"-"===s?(this.state=T.COMMENT_ENDED,this.comment=D(this.opt,this.comment),this.comment&&b(this,"oncomment",this.comment),this.comment=""):(this.comment+="-"+s,this.state=T.COMMENT);continue;case T.COMMENT_ENDED:">"!==s?(x(this,"Malformed comment"),this.comment+="--"+s,this.state=T.COMMENT):this.doctype&&!0!==this.doctype?this.state=T.DOCTYPE_DTD:this.state=T.TEXT;continue;case T.CDATA:for(var a=r-1;s&&"]"!==s;)(s=V(t,r++))&&this.trackPosition&&(this.position++,"\n"===s?(this.line++,this.column=0):this.column++);this.cdata+=t.substring(a,r-1),"]"===s&&(this.state=T.CDATA_ENDING);continue;case T.CDATA_ENDING:"]"===s?this.state=T.CDATA_ENDING_2:(this.cdata+="]"+s,this.state=T.CDATA);continue;case T.CDATA_ENDING_2:">"===s?(this.cdata&&b(this,"oncdata",this.cdata),b(this,"onclosecdata"),this.cdata="",this.state=T.TEXT):"]"===s?this.cdata+="]":(this.cdata+="]]"+s,this.state=T.CDATA);continue;case T.PROC_INST:"?"===s?this.state=T.PROC_INST_ENDING:g(s)?this.state=T.PROC_INST_BODY:this.procInstName+=s;continue;case T.PROC_INST_BODY:!this.procInstBody&&g(s)||("?"===s?this.state=T.PROC_INST_ENDING:this.procInstBody+=s);continue;case T.PROC_INST_ENDING:">"===s?(b(this,"onprocessinginstruction",{name:this.procInstName,body:this.procInstBody}),this.procInstName=this.procInstBody="",this.state=T.TEXT):(this.procInstBody+="?"+s,this.state=T.PROC_INST_BODY);continue;case T.OPEN_TAG:A(f,s)?this.tagName+=s:(function(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,r=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(r.ns=t.ns),e.attribList.length=0,b(e,"onopentagstart",r)}(this),">"===s?I(this):"/"===s?this.state=T.OPEN_TAG_SLASH:(g(s)||x(this,"Invalid character in tag name"),this.state=T.ATTRIB));continue;case T.OPEN_TAG_SLASH:">"===s?(I(this,!0),R(this)):(x(this,"Forward-slash in opening tag not followed by >"),this.state=T.ATTRIB);continue;case T.ATTRIB:g(s)||(">"===s?I(this):"/"===s?this.state=T.OPEN_TAG_SLASH:A(p,s)?(this.attribName=s,this.attribValue="",this.state=T.ATTRIB_NAME):x(this,"Invalid attribute name"));continue;case T.ATTRIB_NAME:"="===s?this.state=T.ATTRIB_VALUE:">"===s?(x(this,"Attribute without value"),this.attribValue=this.attribName,O(this),I(this)):g(s)?this.state=T.ATTRIB_NAME_SAW_WHITE:A(f,s)?this.attribName+=s:x(this,"Invalid attribute name");continue;case T.ATTRIB_NAME_SAW_WHITE:"="===s?this.state=T.ATTRIB_VALUE:g(s)||(x(this,"Attribute without value"),this.tag.attributes[this.attribName]="",this.attribValue="",b(this,"onattribute",{name:this.attribName,value:""}),this.attribName="",">"===s?I(this):A(p,s)?(this.attribName=s,this.state=T.ATTRIB_NAME):(x(this,"Invalid attribute name"),this.state=T.ATTRIB));continue;case T.ATTRIB_VALUE:g(s)||(E(s)?(this.q=s,this.state=T.ATTRIB_VALUE_QUOTED):(this.opt.unquotedAttributeValues||N(this,"Unquoted attribute value"),this.state=T.ATTRIB_VALUE_UNQUOTED,this.attribValue=s));continue;case T.ATTRIB_VALUE_QUOTED:if(s!==this.q){"&"===s?this.state=T.ATTRIB_VALUE_ENTITY_Q:this.attribValue+=s;continue}O(this),this.q="",this.state=T.ATTRIB_VALUE_CLOSED;continue;case T.ATTRIB_VALUE_CLOSED:g(s)?this.state=T.ATTRIB:">"===s?I(this):"/"===s?this.state=T.OPEN_TAG_SLASH:A(p,s)?(x(this,"No whitespace between attributes"),this.attribName=s,this.attribValue="",this.state=T.ATTRIB_NAME):x(this,"Invalid attribute name");continue;case T.ATTRIB_VALUE_UNQUOTED:if(!(">"===(n=s)||g(n))){"&"===s?this.state=T.ATTRIB_VALUE_ENTITY_U:this.attribValue+=s;continue}O(this),">"===s?I(this):this.state=T.ATTRIB;continue;case T.CLOSE_TAG:this.tagName?">"===s?R(this):A(f,s)?this.tagName+=s:this.script?(this.script+="</"+this.tagName+s,this.tagName="",this.state=T.SCRIPT):(g(s)||x(this,"Invalid tagname in closing tag"),this.state=T.CLOSE_TAG_SAW_WHITE):g(s)||(A(p,s)?this.tagName=s:this.script?(this.script+="</"+s,this.state=T.SCRIPT):x(this,"Invalid tagname in closing tag."));continue;case T.CLOSE_TAG_SAW_WHITE:if(g(s))continue;">"===s?R(this):x(this,"Invalid characters in closing tag");continue;case T.TEXT_ENTITY:case T.ATTRIB_VALUE_ENTITY_Q:case T.ATTRIB_VALUE_ENTITY_U:switch(this.state){case T.TEXT_ENTITY:o=T.TEXT,c="textNode";break;case T.ATTRIB_VALUE_ENTITY_Q:o=T.ATTRIB_VALUE_QUOTED,c="attribValue";break;case T.ATTRIB_VALUE_ENTITY_U:o=T.ATTRIB_VALUE_UNQUOTED,c="attribValue"}if(";"===s){var n,o,c,l=function(e){var t,r=e.entity,s=r.toLowerCase(),a="";return e.ENTITIES[r]?e.ENTITIES[r]:e.ENTITIES[s]?e.ENTITIES[s]:("#"===(r=s).charAt(0)&&(a="x"===r.charAt(1)?(t=parseInt(r=r.slice(2),16)).toString(16):(t=parseInt(r=r.slice(1),10)).toString(10)),r=r.replace(/^0+/,""),isNaN(t)||a.toLowerCase()!==r||t<0||t>1114111)?(x(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t)}(this);this.opt.unparsedEntities&&!Object.values(e.XML_ENTITIES).includes(l)?(this.entity="",this.state=o,this.write(l)):(this[c]+=l,this.entity="",this.state=o)}else A(this.entity.length?y:m,s)?this.entity+=s:(x(this,"Invalid character in entity name"),this[c]+="&"+this.entity+s,this.entity="",this.state=o);continue;default:throw Error(this,"Unknown state: "+this.state)}return this.position>=this.bufferCheckPosition&&function(t){for(var r=Math.max(e.MAX_BUFFER_LENGTH,10),s=0,a=0,n=i.length;a<n;a++){var o=t[i[a]].length;if(o>r)switch(i[a]){case"textNode":F(t);break;case"cdata":b(t,"oncdata",t.cdata),t.cdata="";break;case"script":b(t,"onscript",t.script),t.script="";break;default:N(t,"Max buffer length exceeded: "+i[a])}s=Math.max(s,o)}var c=e.MAX_BUFFER_LENGTH-s;t.bufferCheckPosition=c+t.position}(this),this},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){F(this),""!==this.cdata&&(b(this,"oncdata",this.cdata),this.cdata=""),""!==this.script&&(b(this,"onscript",this.script),this.script="")}};try{n=r(6162).Stream}catch(e){n=function(){}}n||(n=function(){});var c=e.EVENTS.filter(function(e){return"error"!==e&&"end"!==e});function l(e,t){if(!(this instanceof l))return new l(e,t);n.apply(this),this._parser=new o(e,t),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(e){r.emit("error",e),r._parser.error=null},this._decoder=null,c.forEach(function(e){Object.defineProperty(r,"on"+e,{get:function(){return r._parser["on"+e]},set:function(t){if(!t)return r.removeAllListeners(e),r._parser["on"+e]=t,t;r.on(e,t)},enumerable:!0,configurable:!1})})}l.prototype=Object.create(n.prototype,{constructor:{value:l}}),l.prototype.write=function(e){return"function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)&&(this._decoder||(this._decoder=new TextDecoder("utf8")),e=this._decoder.decode(e,{stream:!0})),this._parser.write(e.toString()),this.emit("data",e),!0},l.prototype.end=function(e){if(e&&e.length&&this.write(e),this._decoder){var t=this._decoder.decode();t&&(this._parser.write(t),this.emit("data",t))}return this._parser.end(),!0},l.prototype.on=function(e,t){var r=this;return r._parser["on"+e]||-1===c.indexOf(e)||(r._parser["on"+e]=function(){var t=1==arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),r.emit.apply(r,t)}),n.prototype.on.call(r,e,t)};var u="http://www.w3.org/XML/1998/namespace",d="http://www.w3.org/2000/xmlns/",h={xml:u,xmlns:d},p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,f=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function g(e){return" "===e||"\n"===e||"\r"===e||"	"===e}function E(e){return'"'===e||"'"===e}function A(e,t){return e.test(t)}var T=0;for(var v in e.STATE={BEGIN:T++,BEGIN_WHITESPACE:T++,TEXT:T++,TEXT_ENTITY:T++,OPEN_WAKA:T++,SGML_DECL:T++,SGML_DECL_QUOTED:T++,DOCTYPE:T++,DOCTYPE_QUOTED:T++,DOCTYPE_DTD:T++,DOCTYPE_DTD_QUOTED:T++,COMMENT_STARTING:T++,COMMENT:T++,COMMENT_ENDING:T++,COMMENT_ENDED:T++,CDATA:T++,CDATA_ENDING:T++,CDATA_ENDING_2:T++,PROC_INST:T++,PROC_INST_BODY:T++,PROC_INST_ENDING:T++,OPEN_TAG:T++,OPEN_TAG_SLASH:T++,ATTRIB:T++,ATTRIB_NAME:T++,ATTRIB_NAME_SAW_WHITE:T++,ATTRIB_VALUE:T++,ATTRIB_VALUE_QUOTED:T++,ATTRIB_VALUE_CLOSED:T++,ATTRIB_VALUE_UNQUOTED:T++,ATTRIB_VALUE_ENTITY_Q:T++,ATTRIB_VALUE_ENTITY_U:T++,CLOSE_TAG:T++,CLOSE_TAG_SAW_WHITE:T++,SCRIPT:T++,SCRIPT_ENDING:T++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(t){var r=e.ENTITIES[t],s="number"==typeof r?String.fromCharCode(r):r;e.ENTITIES[t]=s}),e.STATE)e.STATE[e.STATE[v]]=v;function C(e,t,r){e[t]&&e[t](r)}function b(e,t,r){e.textNode&&F(e),C(e,t,r)}function F(e){e.textNode=D(e.opt,e.textNode),e.textNode&&C(e,"ontext",e.textNode),e.textNode=""}function D(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function N(e,t){return F(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=Error(t),e.error=t,C(e,"onerror",t),e}function _(e){return e.sawRoot&&!e.closedRoot&&x(e,"Unclosed root tag"),e.state!==T.BEGIN&&e.state!==T.BEGIN_WHITESPACE&&e.state!==T.TEXT&&N(e,"Unexpected end"),F(e),e.c="",e.closed=!0,C(e,"onend"),o.call(e,e.strict,e.opt),e}function x(e,t){if("object"!=typeof e||!(e instanceof o))throw Error("bad call to strictFail");e.strict&&N(e,t)}function w(e,t){var r=0>e.indexOf(":")?["",e]:e.split(":"),s=r[0],a=r[1];return t&&"xmlns"===e&&(s="xmlns",a=""),{prefix:s,local:a}}function O(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName)){e.attribName=e.attribValue="";return}if(e.opt.xmlns){var t=w(e.attribName,!0),r=t.prefix,s=t.local;if("xmlns"===r){if("xml"===s&&e.attribValue!==u)x(e,"xml: prefix must be bound to "+u+"\nActual: "+e.attribValue);else if("xmlns"===s&&e.attribValue!==d)x(e,"xmlns: prefix must be bound to "+d+"\nActual: "+e.attribValue);else{var a=e.tag,n=e.tags[e.tags.length-1]||e;a.ns===n.ns&&(a.ns=Object.create(n.ns)),a.ns[s]=e.attribValue}}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,b(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}function I(e,t){if(e.opt.xmlns){var r=e.tag,s=w(e.tagName);r.prefix=s.prefix,r.local=s.local,r.uri=r.ns[s.prefix]||"",r.prefix&&!r.uri&&(x(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),r.uri=s.prefix);var a=e.tags[e.tags.length-1]||e;r.ns&&a.ns!==r.ns&&Object.keys(r.ns).forEach(function(t){b(e,"onopennamespace",{prefix:t,uri:r.ns[t]})});for(var n=0,i=e.attribList.length;n<i;n++){var o=e.attribList[n],c=o[0],l=o[1],u=w(c,!0),d=u.prefix,h=u.local,p=""===d?"":r.ns[d]||"",f={name:c,value:l,prefix:d,local:h,uri:p};d&&"xmlns"!==d&&!p&&(x(e,"Unbound namespace prefix: "+JSON.stringify(d)),f.uri=d),e.tag.attributes[c]=f,b(e,"onattribute",f)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),b(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=T.TEXT:e.state=T.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function R(e){if(!e.tagName){x(e,"Weird empty close tag."),e.textNode+="</>",e.state=T.TEXT;return}if(e.script){if("script"!==e.tagName){e.script+="</"+e.tagName+">",e.tagName="",e.state=T.SCRIPT;return}b(e,"onscript",e.script),e.script=""}var t=e.tags.length,r=e.tagName;e.strict||(r=r[e.looseCase]());for(var s=r;t--;)if(e.tags[t].name!==s)x(e,"Unexpected close tag");else break;if(t<0){x(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",e.state=T.TEXT;return}e.tagName=r;for(var a=e.tags.length;a-- >t;){var n=e.tag=e.tags.pop();e.tagName=e.tag.name,b(e,"onclosetag",e.tagName);var i={};for(var o in n.ns)i[o]=n.ns[o];var c=e.tags[e.tags.length-1]||e;e.opt.xmlns&&n.ns!==c.ns&&Object.keys(n.ns).forEach(function(t){var r=n.ns[t];b(e,"onclosenamespace",{prefix:t,uri:r})})}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=T.TEXT}function S(e,t){"<"===t?(e.state=T.OPEN_WAKA,e.startTagPosition=e.position):g(t)||(x(e,"Non-whitespace before first tag."),e.textNode=t,e.state=T.TEXT)}function V(e,t){var r="";return t<e.length&&(r=e.charAt(t)),r}T=e.STATE,String.fromCodePoint||(t=String.fromCharCode,s=Math.floor,a=function(){var e,r,a=[],n=-1,i=arguments.length;if(!i)return"";for(var o="";++n<i;){var c=Number(arguments[n]);if(!isFinite(c)||c<0||c>1114111||s(c)!==c)throw RangeError("Invalid code point: "+c);c<=65535?a.push(c):(c-=65536,e=(c>>10)+55296,r=c%1024+56320,a.push(e,r)),(n+1===i||a.length>16384)&&(o+=t.apply(null,a),a.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:a,configurable:!0,writable:!0}):String.fromCodePoint=a)}(t)},7057:(e,t,r)=>{"use strict";let s;let a=r(9801),n=r(4175),i=r(2616),{env:o}=process;function c(e,t={}){var r;return 0!==(r=function(e,{streamIsTTY:t,sniffFlags:r=!0}={}){let n=function(){if("FORCE_COLOR"in o)return"true"===o.FORCE_COLOR?1:"false"===o.FORCE_COLOR?0:0===o.FORCE_COLOR.length?1:Math.min(Number.parseInt(o.FORCE_COLOR,10),3)}();void 0!==n&&(s=n);let c=r?s:n;if(0===c)return 0;if(r){if(i("color=16m")||i("color=full")||i("color=truecolor"))return 3;if(i("color=256"))return 2}if(e&&!t&&void 0===c)return 0;let l=c||0;if("dumb"===o.TERM)return l;if("win32"===process.platform){let e=a.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some(e=>e in o)||"codeship"===o.CI_NAME?1:l;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){let e=Number.parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:l}(e,{streamIsTTY:e&&e.isTTY,...t}))&&{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3}}i("no-color")||i("no-colors")||i("color=false")||i("color=never")?s=0:(i("color")||i("colors")||i("color=true")||i("color=always"))&&(s=1),e.exports={supportsColor:c,stdout:c({isTTY:n.isatty(1)}),stderr:c({isTTY:n.isatty(2)})}},1625:(e,t,r)=>{"use strict";r.d(t,{createDAVClient:()=>em});var s,a,n,i=r(9092),o=r.n(i),c=r(880),l=r.n(c),u=r(3664),d=r.n(u),h=r(4727);!function(e){e.CALENDAR_SERVER="http://calendarserver.org/ns/",e.CALDAV_APPLE="http://apple.com/ns/ical/",e.CALDAV="urn:ietf:params:xml:ns:caldav",e.CARDDAV="urn:ietf:params:xml:ns:carddav",e.DAV="DAV:"}(s||(s={}));let p={[s.CALDAV]:"xmlns:c",[s.CARDDAV]:"xmlns:card",[s.CALENDAR_SERVER]:"xmlns:cs",[s.CALDAV_APPLE]:"xmlns:ca",[s.DAV]:"xmlns:d"};(function(e){e.CALDAV="c",e.CARDDAV="card",e.CALENDAR_SERVER="cs",e.CALDAV_APPLE="ca",e.DAV="d"})(a||(a={})),function(e){e.VEVENT="VEVENT",e.VTODO="VTODO",e.VJOURNAL="VJOURNAL",e.VFREEBUSY="VFREEBUSY",e.VTIMEZONE="VTIMEZONE",e.VALARM="VALARM"}(n||(n={}));let f=e=>e.replace(/([-_]\w)/g,e=>e[1].toUpperCase()),m="undefined"!=typeof globalThis&&"function"==typeof globalThis.fetch?globalThis.fetch.bind(globalThis):d(),y=e=>{let t=Number(e);if(!Number.isNaN(t))return t;let r=e.toLowerCase();return"true"===r||"false"!==r&&e},g=(e,t)=>{if(!e&&!t)return!0;if(!e||!t)return!1;let r=e.trim(),s=t.trim();if(Math.abs(r.length-s.length)>1)return!1;let a="/"===r.slice(-1)?r.slice(0,-1):r,n="/"===s.slice(-1)?s.slice(0,-1):s;return e.includes(n)||t.includes(a)},E=(e,t)=>{if(!e&&!t)return!0;if(!e||!t)return!1;let r=e.trim(),s=t.trim(),a="/"===r.slice(-1)?r.slice(0,-1):r,n="/"===s.slice(-1)?s.slice(0,-1):s;return e.includes(n)||t.includes(a)},A=e=>e.reduce((e,t)=>({...e,[p[t]]:t}),{}),T=e=>Object.entries(e).reduce((e,[t,r])=>r?{...e,[t]:r}:e,{}),v=(e,t)=>t?{[e]:t}:{},C=(e,t)=>e?t&&0!==t.length?Object.fromEntries(Object.entries(e).filter(([e])=>!t.includes(e))):e:{},b=o()("tsdav:request"),F=async e=>{var t;let{url:r,init:s,convertIncoming:a=!0,parseOutgoing:n=!0,fetchOptions:i={},fetch:o}=e,{headers:c={},body:u,namespace:d,method:h,attributes:p}=s,g=a?l().js2xml({_declaration:{_attributes:{version:"1.0",encoding:"utf-8"}},...u,_attributes:p},{compact:!0,spaces:2,elementNameFn:e=>d&&!/^.+:.+/.test(e)?`${d}:${e}`:e}):u,E={...i};delete E.headers;let A=await (null!=o?o:m)(r,{headers:{"Content-Type":"text/xml;charset=UTF-8",...T(c),...i.headers||{}},body:g,method:h,...E}),v=await A.text();if(!A.ok||!(null===(t=A.headers.get("content-type"))||void 0===t?void 0:t.includes("xml"))||!n||!v)return[{href:A.url,ok:A.ok,status:A.status,statusText:A.statusText,raw:v}];let C=l().xml2js(v,{compact:!0,trim:!0,textFn:(e,t)=>{try{let r=t._parent,s=Object.keys(r),a=s.length,n=s[a-1],i=r[n];if(i.length>0){let t=i.length-1;i[t]=y(e)}else r[n]=y(e)}catch(e){b(e.stack)}},elementNameFn:e=>f(e.replace(/^.+:/,"")),attributesFn:e=>{let t={...e};return delete t.xmlns,t},ignoreDeclaration:!0});return(Array.isArray(C.multistatus.response)?C.multistatus.response:[C.multistatus.response]).map(e=>{var t,r;if(!e)return{status:A.status,statusText:A.statusText,ok:A.ok};let s=/^\S+\s(?<status>\d+)\s(?<statusText>.+)$/.exec(e.status);return{raw:C,href:e.href,status:(null==s?void 0:s.groups)?Number.parseInt(null==s?void 0:s.groups.status,10):A.status,statusText:null!==(r=null===(t=null==s?void 0:s.groups)||void 0===t?void 0:t.statusText)&&void 0!==r?r:A.statusText,ok:!e.error,error:e.error,responsedescription:e.responsedescription,props:(Array.isArray(e.propstat)?e.propstat:[e.propstat]).reduce((e,t)=>({...e,...null==t?void 0:t.prop}),{})}})},D=async e=>{let{url:t,props:r,depth:n,headers:i,headersToExclude:o,fetchOptions:c={},fetch:l}=e;return F({url:t,init:{method:"PROPFIND",headers:C(T({depth:n,...i}),o),namespace:a.DAV,body:{propfind:{_attributes:A([s.CALDAV,s.CALDAV_APPLE,s.CALENDAR_SERVER,s.CARDDAV,s.DAV]),prop:r}}},fetchOptions:c,fetch:l})},N=async e=>{let{url:t,data:r,headers:s,headersToExclude:a,fetchOptions:n={},fetch:i}=e;return(null!=i?i:m)(t,{method:"PUT",body:r,headers:C(s,a),...n})},_=async e=>{let{url:t,data:r,etag:s,headers:a,headersToExclude:n,fetchOptions:i={},fetch:o}=e;return(null!=o?o:m)(t,{method:"PUT",body:r,headers:C(T({"If-Match":s,...a}),n),...i})},x=async e=>{let{url:t,headers:r,etag:s,headersToExclude:a,fetchOptions:n={},fetch:i}=e;return(null!=i?i:m)(t,{method:"DELETE",headers:C(T({"If-Match":s,...r}),a),...n})};function w(e,t){let r=e=>t.every(t=>e[t]);return Array.isArray(e)?e.every(e=>r(e)):r(e)}let O=(e,t)=>t.reduce((t,r)=>e[r]?t:`${t.length?`${t},`:""}${r.toString()}`,""),I=o()("tsdav:collection"),R=async e=>{let{url:t,body:r,depth:s,defaultNamespace:n=a.DAV,headers:i,headersToExclude:o,fetchOptions:c={},fetch:l}=e,u=await F({url:t,init:{method:"REPORT",headers:C(T({depth:s,...i}),o),namespace:n,body:r},fetchOptions:c,fetch:l}),d=u.find(e=>!e.ok||e.status&&e.status>=400);if(d)throw Error(`Collection query failed: ${d.status} ${d.statusText}. ${d.raw?`Raw response: ${d.raw}`:""}`);return 1===u.length&&!u[0].raw&&u[0].status&&u[0].status<300?[]:u},S=async e=>{let{url:t,props:r,depth:s,headers:n,headersToExclude:i,fetchOptions:o={},fetch:c}=e;return F({url:t,init:{method:"MKCOL",headers:C(T({depth:s,...n}),i),namespace:a.DAV,body:r?{mkcol:{set:{prop:r}}}:void 0},fetchOptions:o,fetch:c})},V=async e=>{var t,r,s,n,i;let{collection:o,headers:c,headersToExclude:l,fetchOptions:u={},fetch:d}=e;return null!==(i=null===(n=null===(s=null===(r=null===(t=(await D({url:o.url,props:{[`${a.DAV}:supported-report-set`]:{}},depth:"0",headers:C(c,l),fetchOptions:u,fetch:d}))[0])||void 0===t?void 0:t.props)||void 0===r?void 0:r.supportedReportSet)||void 0===s?void 0:s.supportedReport)||void 0===n?void 0:n.map(e=>Object.keys(e.report)[0]))&&void 0!==i?i:[]},L=async e=>{var t,r,s;let{collection:n,headers:i,headersToExclude:o,fetchOptions:c={},fetch:l}=e,u=(await D({url:n.url,props:{[`${a.CALENDAR_SERVER}:getctag`]:{}},depth:"0",headers:C(i,o),fetchOptions:c,fetch:l})).filter(e=>E(n.url,e.href))[0];if(!u)throw Error("Collection does not exist on server");return{isDirty:`${n.ctag}`!=`${null===(t=u.props)||void 0===t?void 0:t.getctag}`,newCtag:null===(s=null===(r=u.props)||void 0===r?void 0:r.getctag)||void 0===s?void 0:s.toString()}},k=e=>{let{url:t,props:r,headers:n,syncLevel:i,syncToken:o,headersToExclude:c,fetchOptions:l,fetch:u}=e;return F({url:t,init:{method:"REPORT",namespace:a.DAV,headers:C({...n},c),body:{"sync-collection":{_attributes:A([s.CALDAV,s.CARDDAV,s.DAV]),"sync-level":i,"sync-token":o,[`${a.DAV}:prop`]:r}}},fetchOptions:l,fetch:u})},U=async e=>{var t,r,s,n,i,o,c,l,u,d,h;let{collection:p,method:f,headers:m,headersToExclude:y,account:g,detailedResult:A,fetchOptions:T={},fetch:v}=e,b=["accountType","homeUrl"];if(!g||!w(g,b)){if(!g)throw Error("no account for smartCollectionSync");throw Error(`account must have ${O(g,b)} before smartCollectionSync`)}let F=null!=f?f:(null===(t=p.reports)||void 0===t?void 0:t.includes("syncCollection"))?"webdav":"basic";if(I(`smart collection sync with type ${g.accountType} and method ${F}`),"webdav"===F){let e=await k({url:p.url,props:{[`${a.DAV}:getetag`]:{},[`${"caldav"===g.accountType?a.CALDAV:a.CARDDAV}:${"caldav"===g.accountType?"calendar-data":"address-data"}`]:{},[`${a.DAV}:displayname`]:{}},syncLevel:1,syncToken:p.syncToken,headers:C(m,y),fetchOptions:T,fetch:v}),t=e.filter(e=>{var t;let r="caldav"===g.accountType?".ics":".vcf";return(null===(t=e.href)||void 0===t?void 0:t.slice(-4))===r}),u=t.filter(e=>404!==e.status).map(e=>e.href),d=t.filter(e=>404===e.status).map(e=>e.href),h=(u.length&&null!==(s=await (null===(r=null==p?void 0:p.objectMultiGet)||void 0===r?void 0:r.call(p,{url:p.url,props:{[`${a.DAV}:getetag`]:{},[`${"caldav"===g.accountType?a.CALDAV:a.CARDDAV}:${"caldav"===g.accountType?"calendar-data":"address-data"}`]:{}},objectUrls:u,depth:"1",headers:C(m,y),fetchOptions:T,fetch:v})))&&void 0!==s?s:[]).map(e=>{var t,r,s,a,n,i,o,c,l,u;return{url:null!==(t=e.href)&&void 0!==t?t:"",etag:null===(r=e.props)||void 0===r?void 0:r.getetag,data:(null==g?void 0:g.accountType)==="caldav"?null!==(n=null===(a=null===(s=e.props)||void 0===s?void 0:s.calendarData)||void 0===a?void 0:a._cdata)&&void 0!==n?n:null===(i=e.props)||void 0===i?void 0:i.calendarData:null!==(l=null===(c=null===(o=e.props)||void 0===o?void 0:o.addressData)||void 0===c?void 0:c._cdata)&&void 0!==l?l:null===(u=e.props)||void 0===u?void 0:u.addressData}}),f=null!==(n=p.objects)&&void 0!==n?n:[],b=h.filter(e=>f.every(t=>!E(t.url,e.url))),F=f.reduce((e,t)=>{let r=h.find(e=>E(e.url,t.url));return r&&r.etag&&r.etag!==t.etag?[...e,r]:e},[]),D=d.map(e=>({url:e,etag:""})),N=f.filter(e=>h.some(t=>E(e.url,t.url)&&t.etag===e.etag));return{...p,objects:A?{created:b,updated:F,deleted:D}:[...N,...b,...F],syncToken:null!==(l=null===(c=null===(o=null===(i=e[0])||void 0===i?void 0:i.raw)||void 0===o?void 0:o.multistatus)||void 0===c?void 0:c.syncToken)&&void 0!==l?l:p.syncToken}}if("basic"===F){let{isDirty:e,newCtag:t}=await L({collection:p,headers:C(m,y),fetchOptions:T,fetch:v}),r=null!==(u=p.objects)&&void 0!==u?u:[],s=null!==(h=await (null===(d=p.fetchObjects)||void 0===d?void 0:d.call(p,{collection:p,headers:C(m,y),fetchOptions:T,fetch:v})))&&void 0!==h?h:[],a=s.filter(e=>r.every(t=>!E(t.url,e.url))),n=r.reduce((e,t)=>{let r=s.find(e=>E(e.url,t.url));return r&&r.etag&&r.etag!==t.etag?[...e,r]:e},[]),i=r.filter(e=>s.every(t=>!E(t.url,e.url))),o=r.filter(e=>s.some(t=>E(e.url,t.url)&&t.etag===e.etag));if(e)return{...p,objects:A?{created:a,updated:n,deleted:i}:[...o,...a,...n],ctag:t}}return A?{...p,objects:{created:[],updated:[],deleted:[]}}:p},P=o()("tsdav:addressBook"),$=async e=>{let{url:t,props:r,filters:n,depth:i,headers:o,headersToExclude:c,fetchOptions:l={},fetch:u}=e;return R({url:t,body:{"addressbook-query":T({_attributes:A([s.CARDDAV,s.DAV]),[`${a.DAV}:prop`]:r,filter:null!=n?n:{"prop-filter":{_attributes:{name:"FN"}}}})},defaultNamespace:a.CARDDAV,depth:i,headers:C(o,c),fetchOptions:l,fetch:u})},K=async e=>{let{url:t,props:r,objectUrls:n,depth:i,headers:o,headersToExclude:c,fetchOptions:l={},fetch:u}=e;return R({url:t,body:{"addressbook-multiget":T({_attributes:A([s.DAV,s.CARDDAV]),[`${a.DAV}:prop`]:r,[`${a.DAV}:href`]:n})},defaultNamespace:a.CARDDAV,depth:i,headers:C(o,c),fetchOptions:l,fetch:u})},B=async e=>{let{account:t,headers:r,props:s,headersToExclude:n,fetchOptions:i={},fetch:o}=null!=e?e:{},c=["homeUrl","rootUrl"];if(!t||!w(t,c)){if(!t)throw Error("no account for fetchAddressBooks");throw Error(`account must have ${O(t,c)} before fetchAddressBooks`)}return Promise.all((await D({url:t.homeUrl,props:null!=s?s:{[`${a.DAV}:displayname`]:{},[`${a.CALENDAR_SERVER}:getctag`]:{},[`${a.DAV}:resourcetype`]:{},[`${a.DAV}:sync-token`]:{}},depth:"1",headers:C(r,n),fetchOptions:i,fetch:o})).filter(e=>{var t,r;return Object.keys(null!==(r=null===(t=e.props)||void 0===t?void 0:t.resourcetype)&&void 0!==r?r:{}).includes("addressbook")}).map(e=>{var r,s,a,n,i,o,c,l,u;let d=null!==(a=null===(s=null===(r=e.props)||void 0===r?void 0:r.displayname)||void 0===s?void 0:s._cdata)&&void 0!==a?a:null===(n=e.props)||void 0===n?void 0:n.displayname;return P(`Found address book named ${"string"==typeof d?d:""},
             props: ${JSON.stringify(e.props)}`),{url:new URL(null!==(i=e.href)&&void 0!==i?i:"",null!==(o=t.rootUrl)&&void 0!==o?o:"").href,ctag:null===(c=e.props)||void 0===c?void 0:c.getctag,displayName:"string"==typeof d?d:"",resourcetype:Object.keys(null===(l=e.props)||void 0===l?void 0:l.resourcetype),syncToken:null===(u=e.props)||void 0===u?void 0:u.syncToken}}).map(async e=>({...e,reports:await V({collection:e,headers:C(r,n),fetchOptions:i,fetch:o})})))},j=async e=>{let{addressBook:t,headers:r,objectUrls:s,headersToExclude:n,urlFilter:i=e=>e,useMultiGet:o=!0,fetchOptions:c={},fetch:l}=e;P(`Fetching vcards from ${null==t?void 0:t.url}`);let u=["url"];if(!t||!w(t,u)){if(!t)throw Error("cannot fetchVCards for undefined addressBook");throw Error(`addressBook must have ${O(t,u)} before fetchVCards`)}let d=(null!=s?s:(await $({url:t.url,props:{[`${a.DAV}:getetag`]:{}},depth:"1",headers:C(r,n),fetchOptions:c,fetch:l})).map(e=>{var t;return null!==(t=e.href)&&void 0!==t?t:""})).map(e=>e.startsWith("http")||!e?e:new URL(e,t.url).href).filter(e=>e&&!g(e,t.url)).filter(i).map(e=>new URL(e).pathname),h=[];return d.length>0&&(h=o?await K({url:t.url,props:{[`${a.DAV}:getetag`]:{},[`${a.CARDDAV}:address-data`]:{}},objectUrls:d,depth:"1",headers:C(r,n),fetchOptions:c,fetch:l}):await $({url:t.url,props:{[`${a.DAV}:getetag`]:{},[`${a.CARDDAV}:address-data`]:{}},depth:"1",headers:C(r,n),fetchOptions:c,fetch:l})),h.map(e=>{var r,s,a,n,i,o;return{url:new URL(null!==(r=e.href)&&void 0!==r?r:"",t.url).href,etag:null===(s=e.props)||void 0===s?void 0:s.getetag,data:null!==(i=null===(n=null===(a=e.props)||void 0===a?void 0:a.addressData)||void 0===n?void 0:n._cdata)&&void 0!==i?i:null===(o=e.props)||void 0===o?void 0:o.addressData}})},M=async e=>{let{addressBook:t,vCardString:r,filename:s,headers:a,headersToExclude:n,fetchOptions:i={},fetch:o}=e;return N({url:new URL(s,t.url).href,data:r,headers:C({"content-type":"text/vcard; charset=utf-8","If-None-Match":"*",...a},n),fetchOptions:i,fetch:o})},G=async e=>{let{vCard:t,headers:r,headersToExclude:s,fetchOptions:a={},fetch:n}=e;return _({url:t.url,data:t.data,etag:t.etag,headers:C({"content-type":"text/vcard; charset=utf-8",...r},s),fetchOptions:a,fetch:n})},Y=async e=>{let{vCard:t,headers:r,headersToExclude:s,fetchOptions:a={},fetch:n}=e;return x({url:t.url,etag:t.etag,headers:C(r,s),fetchOptions:a,fetch:n})},q=o()("tsdav:calendar"),H=async e=>{var t,r,s;let{account:n,headers:i,headersToExclude:o,fetchOptions:c={},fetch:l}=e,u=["principalUrl","rootUrl"];if(!w(n,u))throw Error(`account must have ${O(n,u)} before fetchUserAddresses`);q(`Fetch user addresses from ${n.principalUrl}`);let d=(await D({url:n.principalUrl,props:{[`${a.CALDAV}:calendar-user-address-set`]:{}},depth:"0",headers:C(i,o),fetchOptions:c,fetch:l})).find(e=>E(n.principalUrl,e.href));if(!d||!d.ok)throw Error("cannot find calendarUserAddresses");let h=(null===(s=null===(r=null===(t=null==d?void 0:d.props)||void 0===t?void 0:t.calendarUserAddressSet)||void 0===r?void 0:r.href)||void 0===s?void 0:s.filter(Boolean))||[];return q(`Fetched calendar user addresses ${h}`),h},X=async e=>{let{url:t,props:r,filters:n,timezone:i,depth:o,headers:c,headersToExclude:l,fetchOptions:u={},fetch:d}=e;return R({url:t,body:{"calendar-query":T({_attributes:A([s.CALDAV,s.CALENDAR_SERVER,s.CALDAV_APPLE,s.DAV]),[`${a.DAV}:prop`]:r,filter:n,timezone:i})},defaultNamespace:a.CALDAV,depth:o,headers:C(c,l),fetchOptions:u,fetch:d})},z=async e=>{let{url:t,props:r,objectUrls:n,filters:i,timezone:o,depth:c,headers:l,headersToExclude:u,fetchOptions:d={},fetch:h}=e;return R({url:t,body:{"calendar-multiget":T({_attributes:A([s.DAV,s.CALDAV]),[`${a.DAV}:prop`]:r,[`${a.DAV}:href`]:n,filter:i,timezone:o})},defaultNamespace:a.CALDAV,depth:c,headers:C(l,u),fetchOptions:d,fetch:h})},W=async e=>{let{url:t,props:r,depth:n,headers:i,headersToExclude:o,fetchOptions:c={},fetch:l}=e;return F({url:t,init:{method:"MKCALENDAR",headers:C(T({depth:n,...i}),o),namespace:a.DAV,body:{[`${a.CALDAV}:mkcalendar`]:{_attributes:A([s.DAV,s.CALDAV,s.CALDAV_APPLE]),set:{prop:r}}}},fetchOptions:c,fetch:l})},Q=async e=>{let{headers:t,account:r,props:s,projectedProps:i,headersToExclude:o,fetchOptions:c={},fetch:l}=null!=e?e:{},u=["homeUrl","rootUrl"];if(!r||!w(r,u)){if(!r)throw Error("no account for fetchCalendars");throw Error(`account must have ${O(r,u)} before fetchCalendars`)}return Promise.all((await D({url:r.homeUrl,props:null!=s?s:{[`${a.CALDAV}:calendar-description`]:{},[`${a.CALDAV}:calendar-timezone`]:{},[`${a.DAV}:displayname`]:{},[`${a.CALDAV_APPLE}:calendar-color`]:{},[`${a.CALENDAR_SERVER}:getctag`]:{},[`${a.DAV}:resourcetype`]:{},[`${a.CALDAV}:supported-calendar-component-set`]:{},[`${a.DAV}:sync-token`]:{}},depth:"1",headers:C(t,o),fetchOptions:c,fetch:l})).filter(e=>{var t,r;return Object.keys(null!==(r=null===(t=e.props)||void 0===t?void 0:t.resourcetype)&&void 0!==r?r:{}).includes("calendar")}).filter(e=>{var t,r,s,a,i,o;return(Array.isArray(null===(r=null===(t=e.props)||void 0===t?void 0:t.supportedCalendarComponentSet)||void 0===r?void 0:r.comp)?null===(s=e.props)||void 0===s?void 0:s.supportedCalendarComponentSet.comp.map(e=>e._attributes.name):[null===(o=null===(i=null===(a=e.props)||void 0===a?void 0:a.supportedCalendarComponentSet)||void 0===i?void 0:i.comp)||void 0===o?void 0:o._attributes.name]).some(e=>Object.values(n).includes(e))}).map(e=>{var t,s,a,n,o,c,l,u,d,h,p,f,m,y,g,E;let A=null===(t=e.props)||void 0===t?void 0:t.calendarDescription,T=null===(s=e.props)||void 0===s?void 0:s.calendarTimezone;return{description:"string"==typeof A?A:"",timezone:"string"==typeof T?T:"",url:new URL(null!==(a=e.href)&&void 0!==a?a:"",null!==(n=r.rootUrl)&&void 0!==n?n:"").href,ctag:null===(o=e.props)||void 0===o?void 0:o.getctag,calendarColor:null===(c=e.props)||void 0===c?void 0:c.calendarColor,displayName:null!==(u=null===(l=e.props)||void 0===l?void 0:l.displayname._cdata)&&void 0!==u?u:null===(d=e.props)||void 0===d?void 0:d.displayname,components:Array.isArray(null===(h=e.props)||void 0===h?void 0:h.supportedCalendarComponentSet.comp)?null===(p=e.props)||void 0===p?void 0:p.supportedCalendarComponentSet.comp.map(e=>e._attributes.name):[null===(m=null===(f=e.props)||void 0===f?void 0:f.supportedCalendarComponentSet.comp)||void 0===m?void 0:m._attributes.name],resourcetype:Object.keys(null===(y=e.props)||void 0===y?void 0:y.resourcetype),syncToken:null===(g=e.props)||void 0===g?void 0:g.syncToken,...v("projectedProps",Object.fromEntries(Object.entries(null!==(E=e.props)&&void 0!==E?E:{}).filter(([e])=>null==i?void 0:i[e])))}}).map(async e=>({...e,reports:await V({collection:e,headers:C(t,o),fetchOptions:c,fetch:l})})))},Z=async e=>{let{calendar:t,objectUrls:r,filters:s,timeRange:n,headers:i,expand:o,urlFilter:c=e=>!!(null==e?void 0:e.includes(".ics")),useMultiGet:l=!0,headersToExclude:u,fetchOptions:d={},fetch:h}=e;if(n){let e=/^\d{4}(-\d\d(-\d\d(T\d\d:\d\d(:\d\d)?(\.\d+)?(([+-]\d\d:\d\d)|Z)?)?)?)?$/i,t=/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(\.\d+)?(([+-]\d\d:\d\d)|Z)?$/i;if((!e.test(n.start)||!e.test(n.end))&&(!t.test(n.start)||!t.test(n.end)))throw Error("invalid timeRange format, not in ISO8601")}q(`Fetching calendar objects from ${null==t?void 0:t.url}`);let p=["url"];if(!t||!w(t,p)){if(!t)throw Error("cannot fetchCalendarObjects for undefined calendar");throw Error(`calendar must have ${O(t,p)} before fetchCalendarObjects`)}let f=null!=s?s:[{"comp-filter":{_attributes:{name:"VCALENDAR"},"comp-filter":{_attributes:{name:"VEVENT"},...n?{"time-range":{_attributes:{start:`${new Date(n.start).toISOString().slice(0,19).replace(/[-:.]/g,"")}Z`,end:`${new Date(n.end).toISOString().slice(0,19).replace(/[-:.]/g,"")}Z`}}}:{}}}}],m=[],y=(null!=r?r:(m=await X({url:t.url,props:{[`${a.DAV}:getetag`]:{},...o&&n?{[`${a.CALDAV}:calendar-data`]:{[`${a.CALDAV}:expand`]:{_attributes:{start:`${new Date(n.start).toISOString().slice(0,19).replace(/[-:.]/g,"")}Z`,end:`${new Date(n.end).toISOString().slice(0,19).replace(/[-:.]/g,"")}Z`}}}}:{}},filters:f,depth:"1",headers:C(i,u),fetchOptions:d,fetch:h})).map(e=>{var t;return null!==(t=e.href)&&void 0!==t?t:""})).map(e=>e.startsWith("http")||!e?e:new URL(e,t.url).href).filter(c).map(e=>new URL(e).pathname),g=[];return y.length>0&&(g=o&&!r?m.filter(e=>{var r,s;let a=(null!==(r=e.href)&&void 0!==r?r:"").startsWith("http")?e.href:new URL(null!==(s=e.href)&&void 0!==s?s:"",t.url).href;return c(null!=a?a:"")}):l?await z({url:t.url,props:{[`${a.DAV}:getetag`]:{},[`${a.CALDAV}:calendar-data`]:{...o&&n?{[`${a.CALDAV}:expand`]:{_attributes:{start:`${new Date(n.start).toISOString().slice(0,19).replace(/[-:.]/g,"")}Z`,end:`${new Date(n.end).toISOString().slice(0,19).replace(/[-:.]/g,"")}Z`}}}:{}}},objectUrls:y,depth:"1",headers:C(i,u),fetchOptions:d,fetch:h}):await X({url:t.url,props:{[`${a.DAV}:getetag`]:{},[`${a.CALDAV}:calendar-data`]:{...o&&n?{[`${a.CALDAV}:expand`]:{_attributes:{start:`${new Date(n.start).toISOString().slice(0,19).replace(/[-:.]/g,"")}Z`,end:`${new Date(n.end).toISOString().slice(0,19).replace(/[-:.]/g,"")}Z`}}}:{}}},filters:f,depth:"1",headers:C(i,u),fetchOptions:d,fetch:h})),g.map(e=>{var r,s,a,n,i,o;return{url:new URL(null!==(r=e.href)&&void 0!==r?r:"",t.url).href,etag:`${null===(s=e.props)||void 0===s?void 0:s.getetag}`,data:null!==(i=null===(n=null===(a=e.props)||void 0===a?void 0:a.calendarData)||void 0===n?void 0:n._cdata)&&void 0!==i?i:null===(o=e.props)||void 0===o?void 0:o.calendarData}})},J=async e=>{let{calendar:t,iCalString:r,filename:s,headers:a,headersToExclude:n,fetchOptions:i={},fetch:o}=e;return N({url:new URL(s,t.url).href,data:r,headers:C({"content-type":"text/calendar; charset=utf-8","If-None-Match":"*",...a},n),fetchOptions:i,fetch:o})},ee=async e=>{let{calendarObject:t,headers:r,headersToExclude:s,fetchOptions:a={},fetch:n}=e;return _({url:t.url,data:t.data,etag:t.etag,headers:C({"content-type":"text/calendar; charset=utf-8",...r},s),fetchOptions:a,fetch:n})},et=async e=>{let{calendarObject:t,headers:r,headersToExclude:s,fetchOptions:a={},fetch:n}=e;return x({url:t.url,etag:t.etag,headers:C(r,s),fetchOptions:a,fetch:n})},er=async e=>{var t;let{oldCalendars:r,account:s,detailedResult:a,headers:n,headersToExclude:i,fetchOptions:o={},fetch:c}=e;if(!s)throw Error("Must have account before syncCalendars");let l=null!==(t=null!=r?r:s.calendars)&&void 0!==t?t:[],u=await Q({account:s,headers:C(n,i),fetchOptions:o,fetch:c}),d=u.filter(e=>l.every(t=>!E(t.url,e.url)));q(`new calendars: ${d.map(e=>e.displayName)}`);let h=l.reduce((e,t)=>{let r=u.find(e=>E(e.url,t.url));return r&&(r.syncToken&&`${r.syncToken}`!=`${t.syncToken}`||r.ctag&&`${r.ctag}`!=`${t.ctag}`)?[...e,r]:e},[]);q(`updated calendars: ${h.map(e=>e.displayName)}`);let p=await Promise.all(h.map(async e=>await U({collection:{...e,objectMultiGet:z},method:"webdav",headers:C(n,i),account:s,fetchOptions:o,fetch:c}))),f=l.filter(e=>u.every(t=>!E(t.url,e.url)));q(`deleted calendars: ${f.map(e=>e.displayName)}`);let m=l.filter(e=>u.some(t=>E(t.url,e.url)&&(t.syncToken&&`${t.syncToken}`!=`${e.syncToken}`||t.ctag&&`${t.ctag}`!=`${e.ctag}`)));return a?{created:d,updated:h,deleted:f}:[...m,...d,...p]},es=o()("tsdav:account"),ea=async e=>{var t,r;es("Service discovery...");let{account:s,headers:a,headersToExclude:n,fetchOptions:i={},fetch:o}=e,c=new URL(s.serverUrl),l=new URL(`/.well-known/${s.accountType}`,c);l.protocol=null!==(t=c.protocol)&&void 0!==t?t:"http";try{let e=await (null!=o?o:m)(l.href,{headers:{...C(a,n),"Content-Type":"text/xml;charset=UTF-8"},method:"PROPFIND",body:`<?xml version="1.0" encoding="utf-8" ?>
<d:propfind xmlns:d="DAV:">
  <d:prop>
    <d:resourcetype/>
  </d:prop>
</d:propfind>`,redirect:"manual",...i});if(e.status>=300&&e.status<400){let t=e.headers.get("Location");if("string"==typeof t&&t.length){es(`Service discovery redirected to ${t}`);let e=new URL(t,c);return e.hostname===l.hostname&&l.port&&!e.port&&(e.port=l.port),e.protocol=null!==(r=c.protocol)&&void 0!==r?r:"http",e.href}}}catch(e){es(`Service discovery failed: ${e.stack}`)}return c.href},en=async e=>{var t,r,s,n,i;let{account:o,headers:c,headersToExclude:l,fetchOptions:u={},fetch:d}=e,h=["rootUrl"];if(!w(o,h))throw Error(`account must have ${O(o,h)} before fetchPrincipalUrl`);es(`Fetching principal url from path ${o.rootUrl}`);let[p]=await D({url:o.rootUrl,props:{[`${a.DAV}:current-user-principal`]:{}},depth:"0",headers:C(c,l),fetchOptions:u,fetch:d});if(!p.ok&&(es(`Fetch principal url failed: ${p.statusText}`),401===p.status))throw Error("Invalid credentials");return es(`Fetched principal url ${null===(r=null===(t=p.props)||void 0===t?void 0:t.currentUserPrincipal)||void 0===r?void 0:r.href}`),new URL(null!==(i=null===(n=null===(s=p.props)||void 0===s?void 0:s.currentUserPrincipal)||void 0===n?void 0:n.href)&&void 0!==i?i:"",o.rootUrl).href},ei=async e=>{var t,r;let{account:s,headers:n,headersToExclude:i,fetchOptions:o={},fetch:c}=e,l=["principalUrl","rootUrl"];if(!w(s,l))throw Error(`account must have ${O(s,l)} before fetchHomeUrl`);es(`Fetch home url from ${s.principalUrl}`);let u=await D({url:s.principalUrl,props:"caldav"===s.accountType?{[`${a.CALDAV}:calendar-home-set`]:{}}:{[`${a.CARDDAV}:addressbook-home-set`]:{}},depth:"0",headers:C(n,i),fetchOptions:o,fetch:c}),d=u.find(e=>E(s.principalUrl,e.href));if(!d||!d.ok)throw es(`Fetch home url failed with status ${null==d?void 0:d.statusText} and error ${JSON.stringify(u.map(e=>e.error))}`),Error("cannot find homeUrl");let h=new URL("caldav"===s.accountType?null===(t=null==d?void 0:d.props)||void 0===t?void 0:t.calendarHomeSet.href:null===(r=null==d?void 0:d.props)||void 0===r?void 0:r.addressbookHomeSet.href,s.rootUrl).href;return es(`Fetched home url ${h}`),h},eo=async e=>{let{account:t,headers:r,loadCollections:s=!1,loadObjects:a=!1,headersToExclude:n,fetchOptions:i={},fetch:o}=e,c={...t};return c.rootUrl=await ea({account:t,headers:C(r,n),fetchOptions:i,fetch:o}),c.principalUrl=await en({account:c,headers:C(r,n),fetchOptions:i,fetch:o}),c.homeUrl=await ei({account:c,headers:C(r,n),fetchOptions:i,fetch:o}),(s||a)&&("caldav"===t.accountType?c.calendars=await Q({headers:C(r,n),account:c,fetchOptions:i,fetch:o}):"carddav"===t.accountType&&(c.addressBooks=await B({headers:C(r,n),account:c,fetchOptions:i,fetch:o}))),a&&("caldav"===t.accountType&&c.calendars?c.calendars=await Promise.all(c.calendars.map(async e=>({...e,objects:await Z({calendar:e,headers:C(r,n),fetchOptions:i,fetch:o})}))):"carddav"===t.accountType&&c.addressBooks&&(c.addressBooks=await Promise.all(c.addressBooks.map(async e=>({...e,objects:await j({addressBook:e,headers:C(r,n),fetchOptions:i,fetch:o})}))))),c},ec=o()("tsdav:authHelper"),el=(e,t)=>(...r)=>e({...t,...r[0]}),eu=e=>(ec(`Basic auth token generated: ${(0,h.encode)(`${e.username}:${e.password}`)}`),{authorization:`Basic ${(0,h.encode)(`${e.username}:${e.password}`)}`}),ed=e=>({authorization:`Bearer ${e.accessToken}`}),eh=async(e,t,r)=>{let s=["authorizationCode","redirectUrl","clientId","clientSecret","tokenUrl"];if(!w(e,s))throw Error(`Oauth credentials missing: ${O(e,s)}`);let a=new URLSearchParams({grant_type:"authorization_code",code:e.authorizationCode,redirect_uri:e.redirectUrl,client_id:e.clientId,client_secret:e.clientSecret});ec(e.tokenUrl),ec(a.toString());let n=await (null!=r?r:m)(e.tokenUrl,{method:"POST",body:a.toString(),headers:{"content-length":`${a.toString().length}`,"content-type":"application/x-www-form-urlencoded"},...null!=t?t:{}});return n.ok?await n.json():(ec(`Fetch Oauth tokens failed: ${await n.text()}`),{})},ep=async(e,t,r)=>{let s=["refreshToken","clientId","clientSecret","tokenUrl"];if(!w(e,s))throw Error(`Oauth credentials missing: ${O(e,s)}`);let a=new URLSearchParams({client_id:e.clientId,client_secret:e.clientSecret,refresh_token:e.refreshToken,grant_type:"refresh_token"}),n=await (null!=r?r:m)(e.tokenUrl,{method:"POST",body:a.toString(),headers:{"Content-Type":"application/x-www-form-urlencoded"},...null!=t?t:{}});return n.ok?await n.json():(ec(`Refresh access token failed: ${await n.text()}`),{})},ef=async(e,t,r)=>{var s;ec("Fetching oauth headers");let a={};return e.refreshToken?(e.refreshToken&&!e.accessToken||Date.now()>(null!==(s=e.expiration)&&void 0!==s?s:0))&&(a=await ep(e,t,r)):a=await eh(e,t,r),ec(`Oauth tokens fetched: ${a.access_token}`),{tokens:a,headers:{authorization:`Bearer ${a.access_token}`}}},em=async e=>{var t;let{serverUrl:r,credentials:s,authMethod:a,defaultAccountType:n,authFunction:i,fetch:o}=e,c={};switch(a){case"Basic":c=eu(s);break;case"Bearer":c=ed(s);break;case"Oauth":c=(await ef(s,void 0,o)).headers;break;case"Digest":c={Authorization:`Digest ${s.digestString}`};break;case"Custom":c=null!==(t=await (null==i?void 0:i(s)))&&void 0!==t?t:{};break;default:throw Error("Invalid auth method")}let l=n?await eo({account:{serverUrl:r,credentials:s,accountType:n},headers:c,fetch:o}):void 0,u=async e=>{let{init:t,fetch:r,...s}=e,{headers:a,...n}=t;return F({...s,init:{...n,headers:{...c,...a}},fetch:null!=r?r:o})},d=el(N,{url:r,headers:c,fetch:o}),h=el(_,{headers:c,url:r,fetch:o}),p=el(x,{headers:c,url:r,fetch:o}),f=el(D,{headers:c,fetch:o}),m=async e=>{let{account:t,headers:a,loadCollections:n,loadObjects:i,fetch:l}=e;return eo({account:{serverUrl:r,credentials:s,...t},headers:{...c,...a},loadCollections:n,loadObjects:i,fetch:null!=l?l:o})},y=el(R,{headers:c,fetch:o}),g=el(S,{headers:c,fetch:o}),E=el(k,{headers:c,fetch:o}),A=el(V,{headers:c,fetch:o}),T=el(L,{headers:c,fetch:o}),v=el(U,{headers:c,account:l,fetch:o}),C=el(X,{headers:c,fetch:o}),b=el(z,{headers:c,fetch:o}),w=el(W,{headers:c,fetch:o}),O=el(Q,{headers:c,account:l,fetch:o}),I=el(H,{headers:c,account:l,fetch:o}),P=el(Z,{headers:c,fetch:o}),q=el(J,{headers:c,fetch:o}),es=el(ee,{headers:c,fetch:o}),ea=el(et,{headers:c,fetch:o}),en=el(er,{account:l,headers:c,fetch:o}),ei=el($,{headers:c,fetch:o}),ec=el(K,{headers:c,fetch:o}),eh=el(B,{account:l,headers:c,fetch:o}),ep=el(j,{headers:c,fetch:o});return{davRequest:u,propfind:f,createAccount:m,createObject:d,updateObject:h,deleteObject:p,calendarQuery:C,addressBookQuery:ei,collectionQuery:y,makeCollection:g,calendarMultiGet:b,makeCalendar:w,syncCollection:E,supportedReportSet:A,isCollectionDirty:T,smartCollectionSync:v,fetchCalendars:O,fetchCalendarUserAddresses:I,fetchCalendarObjects:P,createCalendarObject:q,updateCalendarObject:es,deleteCalendarObject:ea,syncCalendars:en,fetchAddressBooks:eh,addressBookMultiGet:ec,fetchVCards:ep,createVCard:el(M,{headers:c,fetch:o}),updateVCard:el(G,{headers:c,fetch:o}),deleteVCard:el(Y,{headers:c,fetch:o})}}},7947:e=>{e.exports={isArray:function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}}},880:(e,t,r)=>{var s=r(424),a=r(2222),n=r(8688),i=r(4924);e.exports={xml2js:s,xml2json:a,js2xml:n,json2xml:i}},8688:(e,t,r)=>{var s,a,n=r(4711),i=r(7947).isArray;function o(e,t,r){return(!r&&e.spaces?"\n":"")+Array(t+1).join(e.spaces)}function c(e,t,r){if(t.ignoreAttributes)return"";"attributesFn"in t&&(e=t.attributesFn(e,a,s));var n,i,c,l,u=[];for(n in e)e.hasOwnProperty(n)&&null!==e[n]&&void 0!==e[n]&&(l=t.noQuotesForNativeAttributes&&"string"!=typeof e[n]?"":'"',i=(i=""+e[n]).replace(/"/g,"&quot;"),c="attributeNameFn"in t?t.attributeNameFn(n,i,a,s):n,u.push(t.spaces&&t.indentAttributes?o(t,r+1,!1):" "),u.push(c+"="+l+("attributeValueFn"in t?t.attributeValueFn(i,n,a,s):i)+l));return e&&Object.keys(e).length&&t.spaces&&t.indentAttributes&&u.push(o(t,r,!1)),u.join("")}function l(e,t,r){return s=e,a="xml",t.ignoreDeclaration?"":"<?xml"+c(e[t.attributesKey],t,r)+"?>"}function u(e,t,r){if(t.ignoreInstruction)return"";for(n in e)if(e.hasOwnProperty(n))break;var n,i="instructionNameFn"in t?t.instructionNameFn(n,e[n],a,s):n;if("object"==typeof e[n])return s=e,a=i,"<?"+i+c(e[n][t.attributesKey],t,r)+"?>";var o=e[n]?e[n]:"";return"instructionFn"in t&&(o=t.instructionFn(o,n,a,s)),"<?"+i+(o?" "+o:"")+"?>"}function d(e,t){return t.ignoreComment?"":"<!--"+("commentFn"in t?t.commentFn(e,a,s):e)+"-->"}function h(e,t){return t.ignoreCdata?"":"<![CDATA["+("cdataFn"in t?t.cdataFn(e,a,s):e.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function p(e,t){return t.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in t?t.doctypeFn(e,a,s):e)+">"}function f(e,t){return t.ignoreText?"":(e=(e=(e=""+e).replace(/&amp;/g,"&")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in t?t.textFn(e,a,s):e)}function m(e,t,r){var s;for(s in e)if(e.hasOwnProperty(s))switch(s){case t.parentKey:case t.attributesKey:break;case t.textKey:if(t.indentText||r)return!0;break;case t.cdataKey:if(t.indentCdata||r)return!0;break;case t.instructionKey:if(t.indentInstruction||r)return!0;break;case t.doctypeKey:case t.commentKey:default:return!0}return!1}e.exports=function(e,t){r=t,y=n.copyOptions(r),n.ensureFlagExists("ignoreDeclaration",y),n.ensureFlagExists("ignoreInstruction",y),n.ensureFlagExists("ignoreAttributes",y),n.ensureFlagExists("ignoreText",y),n.ensureFlagExists("ignoreComment",y),n.ensureFlagExists("ignoreCdata",y),n.ensureFlagExists("ignoreDoctype",y),n.ensureFlagExists("compact",y),n.ensureFlagExists("indentText",y),n.ensureFlagExists("indentCdata",y),n.ensureFlagExists("indentAttributes",y),n.ensureFlagExists("indentInstruction",y),n.ensureFlagExists("fullTagEmptyElement",y),n.ensureFlagExists("noQuotesForNativeAttributes",y),n.ensureSpacesExists(y),"number"==typeof y.spaces&&(y.spaces=Array(y.spaces+1).join(" ")),n.ensureKeyExists("declaration",y),n.ensureKeyExists("instruction",y),n.ensureKeyExists("attributes",y),n.ensureKeyExists("text",y),n.ensureKeyExists("comment",y),n.ensureKeyExists("cdata",y),n.ensureKeyExists("doctype",y),n.ensureKeyExists("type",y),n.ensureKeyExists("name",y),n.ensureKeyExists("elements",y),n.checkFnExists("doctype",y),n.checkFnExists("instruction",y),n.checkFnExists("cdata",y),n.checkFnExists("comment",y),n.checkFnExists("text",y),n.checkFnExists("instructionName",y),n.checkFnExists("elementName",y),n.checkFnExists("attributeName",y),n.checkFnExists("attributeValue",y),n.checkFnExists("attributes",y),n.checkFnExists("fullTagEmptyElement",y),t=y;var r,y,g=[];return s=e,a="_root_",t.compact?g.push(function e(t,r,n,y){var g,E,A,T=[];for(E in t)if(t.hasOwnProperty(E))for(g=0,A=i(t[E])?t[E]:[t[E]];g<A.length;++g){switch(E){case r.declarationKey:T.push(l(A[g],r,n));break;case r.instructionKey:T.push((r.indentInstruction?o(r,n,y):"")+u(A[g],r,n));break;case r.attributesKey:case r.parentKey:break;case r.textKey:T.push((r.indentText?o(r,n,y):"")+f(A[g],r));break;case r.cdataKey:T.push((r.indentCdata?o(r,n,y):"")+h(A[g],r));break;case r.doctypeKey:T.push(o(r,n,y)+p(A[g],r));break;case r.commentKey:T.push(o(r,n,y)+d(A[g],r));break;default:T.push(o(r,n,y)+function(t,r,n,i,l){s=t,a=r;var u="elementNameFn"in n?n.elementNameFn(r,t):r;if(null==t||""===t)return"fullTagEmptyElementFn"in n&&n.fullTagEmptyElementFn(r,t)||n.fullTagEmptyElement?"<"+u+"></"+u+">":"<"+u+"/>";var d=[];if(r){if(d.push("<"+u),"object"!=typeof t)return d.push(">"+f(t,n)+"</"+u+">"),d.join("");t[n.attributesKey]&&d.push(c(t[n.attributesKey],n,i));var h=m(t,n,!0)||t[n.attributesKey]&&"preserve"===t[n.attributesKey]["xml:space"];if(h||(h="fullTagEmptyElementFn"in n?n.fullTagEmptyElementFn(r,t):n.fullTagEmptyElement),!h)return d.push("/>"),d.join("");d.push(">")}return d.push(e(t,n,i+1,!1)),s=t,a=r,r&&d.push((l?o(n,i,!1):"")+"</"+u+">"),d.join("")}(A[g],E,r,n,m(A[g],r)))}y=y&&!T.length}return T.join("")}(e,t,0,!0)):(e[t.declarationKey]&&g.push(l(e[t.declarationKey],t,0)),e[t.elementsKey]&&e[t.elementsKey].length&&g.push(function e(t,r,n,i){return t.reduce(function(t,l){var m,y,g,E=o(r,n,i&&!t);switch(l.type){case"element":return t+E+(s=l,a=l.name,m=[],y="elementNameFn"in r?r.elementNameFn(l.name,l):l.name,m.push("<"+y),l[r.attributesKey]&&m.push(c(l[r.attributesKey],r,n)),(g=l[r.elementsKey]&&l[r.elementsKey].length||l[r.attributesKey]&&"preserve"===l[r.attributesKey]["xml:space"])||(g="fullTagEmptyElementFn"in r?r.fullTagEmptyElementFn(l.name,l):r.fullTagEmptyElement),g?(m.push(">"),l[r.elementsKey]&&l[r.elementsKey].length&&(m.push(e(l[r.elementsKey],r,n+1)),s=l,a=l.name),m.push(r.spaces&&function(e,t){var r;if(e.elements&&e.elements.length)for(r=0;r<e.elements.length;++r)switch(e.elements[r][t.typeKey]){case"text":if(t.indentText)return!0;break;case"cdata":if(t.indentCdata)return!0;break;case"instruction":if(t.indentInstruction)return!0;break;default:return!0}return!1}(l,r)?"\n"+Array(n+1).join(r.spaces):""),m.push("</"+y+">")):m.push("/>"),m.join(""));case"comment":return t+E+d(l[r.commentKey],r);case"doctype":return t+E+p(l[r.doctypeKey],r);case"cdata":return t+(r.indentCdata?E:"")+h(l[r.cdataKey],r);case"text":return t+(r.indentText?E:"")+f(l[r.textKey],r);case"instruction":var A={};return A[l[r.nameKey]]=l[r.attributesKey]?l:l[r.instructionKey],t+(r.indentInstruction?E:"")+u(A,r,n)}},"")}(e[t.elementsKey],t,0,!g.length))),g.join("")}},4924:(e,t,r)=>{var s=r(8688);e.exports=function(e,t){e instanceof Buffer&&(e=e.toString());var r=null;if("string"==typeof e)try{r=JSON.parse(e)}catch(e){throw Error("The JSON structure is invalid")}else r=e;return s(r,t)}},4711:(e,t,r)=>{var s=r(7947).isArray;e.exports={copyOptions:function(e){var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r},ensureFlagExists:function(e,t){e in t&&"boolean"==typeof t[e]||(t[e]=!1)},ensureSpacesExists:function(e){"spaces"in e&&("number"==typeof e.spaces||"string"==typeof e.spaces)||(e.spaces=0)},ensureAlwaysArrayExists:function(e){"alwaysArray"in e&&("boolean"==typeof e.alwaysArray||s(e.alwaysArray))||(e.alwaysArray=!1)},ensureKeyExists:function(e,t){e+"Key" in t&&"string"==typeof t[e+"Key"]||(t[e+"Key"]=t.compact?"_"+e:e)},checkFnExists:function(e,t){return e+"Fn" in t}}},424:(e,t,r)=>{var s,a,n=r(5074),i=r(4711),o=r(7947).isArray;function c(e){var t=Number(e);if(!isNaN(t))return t;var r=e.toLowerCase();return"true"===r||"false"!==r&&e}function l(e,t){var r;if(s.compact){if(!a[s[e+"Key"]]&&(o(s.alwaysArray)?-1!==s.alwaysArray.indexOf(s[e+"Key"]):s.alwaysArray)&&(a[s[e+"Key"]]=[]),a[s[e+"Key"]]&&!o(a[s[e+"Key"]])&&(a[s[e+"Key"]]=[a[s[e+"Key"]]]),e+"Fn" in s&&"string"==typeof t&&(t=s[e+"Fn"](t,a)),"instruction"===e&&("instructionFn"in s||"instructionNameFn"in s)){for(r in t)if(t.hasOwnProperty(r)){if("instructionFn"in s)t[r]=s.instructionFn(t[r],r,a);else{var n=t[r];delete t[r],t[s.instructionNameFn(r,n,a)]=n}}}o(a[s[e+"Key"]])?a[s[e+"Key"]].push(t):a[s[e+"Key"]]=t}else{a[s.elementsKey]||(a[s.elementsKey]=[]);var i={};if(i[s.typeKey]=e,"instruction"===e){for(r in t)if(t.hasOwnProperty(r))break;i[s.nameKey]="instructionNameFn"in s?s.instructionNameFn(r,t,a):r,s.instructionHasAttributes?(i[s.attributesKey]=t[r][s.attributesKey],"instructionFn"in s&&(i[s.attributesKey]=s.instructionFn(i[s.attributesKey],r,a))):("instructionFn"in s&&(t[r]=s.instructionFn(t[r],r,a)),i[s.instructionKey]=t[r])}else e+"Fn" in s&&(t=s[e+"Fn"](t,a)),i[s[e+"Key"]]=t;s.addParent&&(i[s.parentKey]=a),a[s.elementsKey].push(i)}}function u(e){if("attributesFn"in s&&e&&(e=s.attributesFn(e,a)),(s.trim||"attributeValueFn"in s||"attributeNameFn"in s||s.nativeTypeAttributes)&&e){var t;for(t in e)if(e.hasOwnProperty(t)&&(s.trim&&(e[t]=e[t].trim()),s.nativeTypeAttributes&&(e[t]=c(e[t])),"attributeValueFn"in s&&(e[t]=s.attributeValueFn(e[t],t,a)),"attributeNameFn"in s)){var r=e[t];delete e[t],e[s.attributeNameFn(t,e[t],a)]=r}}return e}function d(e){var t={};if(e.body&&("xml"===e.name.toLowerCase()||s.instructionHasAttributes)){for(var r,n=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g;null!==(r=n.exec(e.body));)t[r[1]]=r[2]||r[3]||r[4];t=u(t)}if("xml"===e.name.toLowerCase()){if(s.ignoreDeclaration)return;a[s.declarationKey]={},Object.keys(t).length&&(a[s.declarationKey][s.attributesKey]=t),s.addParent&&(a[s.declarationKey][s.parentKey]=a)}else{if(s.ignoreInstruction)return;s.trim&&(e.body=e.body.trim());var i={};s.instructionHasAttributes&&Object.keys(t).length?(i[e.name]={},i[e.name][s.attributesKey]=t):i[e.name]=e.body,l("instruction",i)}}function h(e,t){var r,n;if("object"==typeof e&&(t=e.attributes,e=e.name),t=u(t),"elementNameFn"in s&&(e=s.elementNameFn(e,a)),s.compact){if(r={},!s.ignoreAttributes&&t&&Object.keys(t).length)for(n in r[s.attributesKey]={},t)t.hasOwnProperty(n)&&(r[s.attributesKey][n]=t[n]);e in a||(o(s.alwaysArray)?-1===s.alwaysArray.indexOf(e):!s.alwaysArray)||(a[e]=[]),a[e]&&!o(a[e])&&(a[e]=[a[e]]),o(a[e])?a[e].push(r):a[e]=r}else a[s.elementsKey]||(a[s.elementsKey]=[]),(r={})[s.typeKey]="element",r[s.nameKey]=e,!s.ignoreAttributes&&t&&Object.keys(t).length&&(r[s.attributesKey]=t),s.alwaysChildren&&(r[s.elementsKey]=[]),a[s.elementsKey].push(r);r[s.parentKey]=a,a=r}function p(e){!s.ignoreText&&(e.trim()||s.captureSpacesBetweenElements)&&(s.trim&&(e=e.trim()),s.nativeType&&(e=c(e)),s.sanitize&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),l("text",e))}function f(e){s.ignoreComment||(s.trim&&(e=e.trim()),l("comment",e))}function m(e){var t=a[s.parentKey];s.addParent||delete a[s.parentKey],a=t}function y(e){s.ignoreCdata||(s.trim&&(e=e.trim()),l("cdata",e))}function g(e){s.ignoreDoctype||(e=e.replace(/^ /,""),s.trim&&(e=e.trim()),l("doctype",e))}function E(e){e.note=e}e.exports=function(e,t){var r=n.parser(!0,{}),o={};if(a=o,s=i.copyOptions(t),i.ensureFlagExists("ignoreDeclaration",s),i.ensureFlagExists("ignoreInstruction",s),i.ensureFlagExists("ignoreAttributes",s),i.ensureFlagExists("ignoreText",s),i.ensureFlagExists("ignoreComment",s),i.ensureFlagExists("ignoreCdata",s),i.ensureFlagExists("ignoreDoctype",s),i.ensureFlagExists("compact",s),i.ensureFlagExists("alwaysChildren",s),i.ensureFlagExists("addParent",s),i.ensureFlagExists("trim",s),i.ensureFlagExists("nativeType",s),i.ensureFlagExists("nativeTypeAttributes",s),i.ensureFlagExists("sanitize",s),i.ensureFlagExists("instructionHasAttributes",s),i.ensureFlagExists("captureSpacesBetweenElements",s),i.ensureAlwaysArrayExists(s),i.ensureKeyExists("declaration",s),i.ensureKeyExists("instruction",s),i.ensureKeyExists("attributes",s),i.ensureKeyExists("text",s),i.ensureKeyExists("comment",s),i.ensureKeyExists("cdata",s),i.ensureKeyExists("doctype",s),i.ensureKeyExists("type",s),i.ensureKeyExists("name",s),i.ensureKeyExists("elements",s),i.ensureKeyExists("parent",s),i.checkFnExists("doctype",s),i.checkFnExists("instruction",s),i.checkFnExists("cdata",s),i.checkFnExists("comment",s),i.checkFnExists("text",s),i.checkFnExists("instructionName",s),i.checkFnExists("elementName",s),i.checkFnExists("attributeName",s),i.checkFnExists("attributeValue",s),i.checkFnExists("attributes",s),r.opt={strictEntities:!0},r.onopentag=h,r.ontext=p,r.oncomment=f,r.onclosetag=m,r.onerror=E,r.oncdata=y,r.ondoctype=g,r.onprocessinginstruction=d,r.write(e).close(),o[s.elementsKey]){var c=o[s.elementsKey];delete o[s.elementsKey],o[s.elementsKey]=c,delete o.text}return o}},2222:(e,t,r)=>{var s=r(4711),a=r(424);e.exports=function(e,t){var r,n,i;return i=s.copyOptions(t),s.ensureSpacesExists(i),r=a(e,i),n="compact"in i&&i.compact?"_parent":"parent",("addParent"in i&&i.addParent?JSON.stringify(r,function(e,t){return e===n?"_":t},i.spaces):JSON.stringify(r,null,i.spaces)).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}}};