"use strict";(()=>{var e={};e.id=132,e.ids=[132],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6853:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>h,patchFetch:()=>w,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>d,staticGenerationAsyncStorage:()=>c});var r={};s.r(r),s.d(r,{GET:()=>u});var n=s(9303),i=s(8716),o=s(670),a=s(7070);async function u(e){let{searchParams:t}=new URL(e.url),s=t.get("group_id"),r=t.get("limit")||"20",n=process.env.SPLITWISE_ACCESS_TOKEN;if(!n)return a.NextResponse.json({error:"Splitwise access token not configured. Set SPLITWISE_ACCESS_TOKEN in .env.local"},{status:500});try{let e=`https://secure.splitwise.com/api/v3.0/get_expenses?limit=${r}`;s&&(e+=`&group_id=${s}`);let t=await fetch(e,{headers:{Authorization:`Bearer ${n}`}});if(!t.ok){let e=await t.text();return console.error("Splitwise API error:",e),a.NextResponse.json({error:`Splitwise API returned ${t.status}`},{status:502})}let i=(await t.json()).expenses||[],o=await fetch("https://secure.splitwise.com/api/v3.0/get_current_user",{headers:{Authorization:`Bearer ${n}`}}),u=await o.json(),l=u.user?.id;if(!l)return a.NextResponse.json({error:"Could not determine Splitwise user"},{status:500});let p=i.filter(e=>!e.deleted_at&&parseFloat(e.cost)>0).map(e=>{let t=e.users?.find(e=>e.user_id===l),s=t?parseFloat(t.owed_share):0,r=(e.description||"").toLowerCase(),n="Other";return r.includes("food")||r.includes("lunch")||r.includes("dinner")||r.includes("breakfast")||r.includes("restaurant")||r.includes("swiggy")||r.includes("zomato")?n="Food":r.includes("uber")||r.includes("ola")||r.includes("cab")||r.includes("metro")||r.includes("fuel")||r.includes("petrol")?n="Transport":r.includes("electric")||r.includes("rent")||r.includes("wifi")||r.includes("internet")||r.includes("bill")?n="Bills":(r.includes("shop")||r.includes("amazon")||r.includes("flipkart"))&&(n="Shopping"),{amount:s,category:n,note:`[Splitwise] ${e.description||"Expense"}`,date:e.date||new Date().toISOString()}}).filter(e=>e.amount>0);return a.NextResponse.json(p)}catch(e){return console.error("Splitwise sync error:",e),a.NextResponse.json({error:e.message||"Failed to sync with Splitwise"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/expenses/sync/route",pathname:"/api/expenses/sync",filename:"route",bundlePath:"app/api/expenses/sync/route"},resolvedPagePath:"C:\\Users\\kharw\\OneDrive\\Desktop\\ai-assistant\\src\\app\\api\\expenses\\sync\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:c,serverHooks:d}=l,h="/api/expenses/sync/route";function w(){return(0,o.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:c})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,972],()=>s(6853));module.exports=r})();